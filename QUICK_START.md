# Быстрый старт с telegram-audio-bot

## Подготовка

### 1. Клонирование репозитория
```bash
git clone https://github.com/ваш-аккаунт/telegram-audio-bot.git
cd telegram-audio-bot
```

### 2. Создание Telegram-бота
1. Найдите в Telegram бота @BotFather
2. Отправьте команду `/newbot`
3. Следуйте инструкциям для создания нового бота
4. Скопируйте токен, который вы получите

## Установка и запуск

### Вариант 1: Docker Compose (рекомендуется)

1. **Установите переменные окружения:**
```bash
echo "BOT_TOKEN=ваш_токен_бота" > .env
```

2. **Запустите бота:**
```bash
docker-compose up -d
```

3. **Проверьте статус:**
```bash
docker-compose ps
```

### Вариант 2: Локальный запуск

1. **Установите зависимости:**
```bash
pip install -r requirements.txt
```

2. **Запустите бота:**
```bash
BOT_TOKEN=ваш_токен_бота python bot_refactored.py
```

## Структура проекта

```
├── bot_refactored.py     # Основной файл с улучшенной архитектурой
├── requirements.txt      # Зависимости Python
├── Dockerfile           # Определение контейнера
├── docker-compose.yml   # Оркестрация контейнеров
├── README.md            # Документация
├── ANALYSIS_SUMMARY.md  # Сводка по анализу и улучшениям
├── ARCHITECTURE.md      # Описание архитектуры
├── TESTING.md           # Рекомендации по тестированию
├── DEPLOYMENT.md        # Руководство по развертыванию
├── TROUBLESHOOTING.md   # Руководство по устранению неполадок
├── FUTURE_IMPROVEMENTS.md # План по улучшению проекта
└── QUICK_START.md       # Этот файл
```

## Основные особенности улучшенной версии

### 1. Архитектурные улучшения
- **Разделение на классы**: `UserSessionManager`, `AudioProcessor`, `AudioBot`
- **Типизация**: аннотации типов для всех методов
- **Модульность**: четкое разделение ответственностей

### 2. Безопасность
- **Ограничение размера файлов**: до 50MB
- **Управление сессиями с TTL**: автоматическая очистка через 30 минут
- **Защита от повторной обработки**: проверка метки "[ENHANCED]"

### 3. Производительность
- **Использование временных файлов**: снижение потребления памяти
- **Корректная очистка ресурсов**: гарантированное удаление временных файлов
- **Асинхронная обработка**: не блокирует другие операции

## Тестирование функциональности

### 1. Проверка запуска
1. Запустите бота
2. Отправьте команду `/start` в Telegram
3. Убедитесь, что бот отвечает и показывает меню

### 2. Проверка обработки аудио
1. Выберите действие (например, "Анализ качества")
2. Отправьте аудио файл
3. Убедитесь, что бот корректно обрабатывает файл

### 3. Проверка безопасности
1. Попробуйте отправить файл больше 50MB
2. Убедитесь, что бот отклоняет его с сообщением об ошибке

## Основные команды для разработки

### Работа с Docker
```bash
# Сборка образа
docker-compose build

# Запуск в фоне
docker-compose up -d

# Просмотр логов
docker-compose logs -f

# Остановка
docker-compose down

# Перезапуск
docker-compose restart
```

### Проверка кода
```bash
# Проверка синтаксиса Python
python -m py_compile bot_refactored.py

# Запуск с проверкой зависимостей
python bot_refactored.py
```

## Устранение типичных проблем

### Бот не отвечает
1. Проверьте правильность токена в файле `.env`
2. Убедитесь, что бот не заблокирован пользователем
3. Проверьте логи: `docker-compose logs audio-bot`

### Ошибка при обработке аудио
1. Убедитесь, что файл не поврежден
2. Проверьте формат файла (должен быть поддерживаемым)
3. Убедитесь, что размер файла не превышает 50MB

### Высокое потребление памяти
1. Проверьте количество активных сессий
2. Убедитесь, что временные файлы очищаются
3. Перезапустите контейнер при необходимости

## Дальнейшие шаги

1. **Ознакомьтесь с полной документацией:**
   - `ARCHITECTURE.md` - архитектура проекта
   - `TESTING.md` - рекомендации по тестированию
   - `DEPLOYMENT.md` - руководство по развертыванию

2. **Настройте мониторинг:**
   - Добавьте логирование в вашу систему
   - Настройте алертинг на ошибки

3. **Рассмотрите улучшения:**
   - `FUTURE_IMPROVEMENTS.md` содержит план по дальнейшему развитию

## Контакты

Если у вас возникли вопросы или проблемы:
- Создайте issue в репозитории проекта
- Проверьте файлы документации в корне проекта
- Ознакомьтесь с `TROUBLESHOOTING.md` для решения типичных проблем